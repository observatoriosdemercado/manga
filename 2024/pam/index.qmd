---
title: "OBSERVATÓRIO DO MERCADO DE MANGA DA EMBRAPA SEMIÁRIDO"
author: "João Ricardo F. de Lima"
date: "today"
editor: source
lang: pt
language: 
  toc-title-document: '<a href="https://observatoriosdemercado.github.io/manga/" target="_blank"><img src="https://github.com/observatoriosdemercado/manga/blob/main/logo_embrapa.jpg?raw=true" alt="Logotipo Embrapa" width="150"></a>'
format: 
  html:
    toc: true
    toc_float:
      collapsed: yes
      smooth_scroll: yes
    toc-location: left
    code-fold: false
    embed-resources: true
    page-layout: full
#    fig-asp: 0.618
    fig-width: 10
    fig-height: 8
#    fig-dpi: 200
    fig-align: center
    df-print: paged
theme:
  light: flatly
execute:
  echo: false
  message: false
  warning: false
---

```{r setup, include=FALSE}
library(lubridate)
today <- as.Date("2023-01-01")
date <- seq(as.Date('2023-01-01'),to=as.Date('2023-12-01'),by='1 month')
```

<hr>

# ATUALIZAÇÃO DA INFORMAÇÕES SOBRE A CULTURA DA MANGA COM DADOS DA PAM/IBGE ATÉ 2023.

<hr>

Os dados utilizados são da Pesquisa Agrícola Municipal (PAM) do IBGE e são anuais relativos ao período de 2013 a 2023.

Em 2023, a área plantada no Brasil foi de aproximadamente 80,7 mil hectares (ha). As duas regiões que concentram a produção nacional são a Nordeste 62 mil ha (76,85% do total) e a Sudeste 17,7 mil ha (21,98% do total). Os estados da Bahia (33,4 mil ha); Pernambuco (18,2 mil ha); São Paulo (10,3 mil ha), Minas Gerais (6,3 mil ha), Ceará (4,3 mil ha ) e Rio Grande do Norte (2,7 mil ha) representam, respectivamente, 41,4%, 22,5%, 12,7%, 7,8% e 5,3% e 3,4% do total nacional. O Vale do São Francisco mantém sua trajetória de crescimento de área, saindo de 36,4 mil ha em 2022 para 37,9 mil ha em 2023, segundo o IBGE (2024), um aumento de 4%.

Em termos de volumes, em 2023, o Brasil colheu cerca de 1,76 milhões de toneladas (t), com o Nordeste participando com aproximadamente 81% de todo este volume e o Vale do São Francisco, sozinho, representando 66% do total nacional. As quatro cidades com maiores volumes de produção são, respectivamente, Juazeiro (BA) com 377 mil t, Petrolina (PE) com 376 mil t, Belém do São Francisco (PE) com 154 mil t e Casa Nova (BA) com 112 mil t. Os volumes somados representam quase 72% de toda a produção do Nordeste. O Vale do São Francisco ultrapassou a marca de 1,16 milhões toneladas, um crescimento de 10,7% em relação ao volume de 2022.

Sobre a produtividade, a média, em 2023, da região Nordeste (23 t/ha) é maior do que a média nacional (21,8 t/ha). Segundo o IBGE, o estado de Pernambuco possui a maior produtividade média (33,1 t/ha), seguido da Bahia (21.1 t/ha) e São Paulo (21 t/ha). O Vale do São Francisco possui uma produtividade superior a média regional, cerca de 21 t/ha, na média. No ano de 2014, a produtividade nesta região foi de 22 t/ha. Assim, a explicação para o grande crescimento do volume de mangas no Vale do São Francisco tem dois fatores, o crescimento da área e o crescimento da produtividade por área.

A manga gerou quase 3,2 bilhões de reais em valor da produção no Brasil, em 2023, sendo que quase 70% deste total, 2,2 bilhões de reais, teve origem no Vale do Submédio São Francisco.

<br>

# 1. ATUALIZAÇÃO DADOS SOBRE ÁREA DA CULTURA DA MANGA.

## 1.1 ÁREA NO BRASIL E REGIÕES PRODUTORAS

::: panel-tabset
### GRÁFICO

```{r ibge_manga1}
#Direcionado o R para o Diretorio a ser trabalhado
setwd('/Users/jricardofl/Dropbox/tempecon/dados_manga/2024')

#Inicio do Script
#Pacotes a serem utilizados 
library(ggplot2)
library(ggthemes)
library(dplyr)
library(tidyverse)
library(scales)
library(kableExtra)# complex tables
library(magrittr)# pipe operations
library(readxl)
library(reshape2)
library(plotly)
library(DT)

mycolors2 <- c("darkgray", "lightblue3", "orange", "darkblue", "red", "darkgreen", "gold", "#0A6269", "#690F0A", "#6675E6" )
mycolors3 <- c("orange")

#Entrando dados no R
#dados1 <- read_excel("area_regioes.xlsx", col_names = TRUE)
#dados1 <- dados1[c(1,3,4),]
dados1 <- read_excel("area_regioes.xlsx", col_names = TRUE, skip = 4, col_types = c('text', "numeric", "numeric", "numeric", "numeric", "numeric", "numeric", "numeric", "numeric", "numeric", "numeric"), na="-")
colnames(dados1)[1] <- 'regiao'
dados1 <- dados1[-nrow(dados1),]

dados1m <- melt(dados1, id.var='regiao')
dados1m_area <- dados1m

g1 <- ggplot()+
  geom_col(data=dados1m, aes(x=reorder(regiao, -value), y=value/1000, fill=variable), lwd=1, position = "dodge")+ scale_fill_manual(values=mycolors2)+
  labs(y= "Área Plantada de Manga (1000 ha)", x= "Brasil e Regiões", title='',
       caption = "Fonte: PAM/IBGE reprocessado pelo Observatório de Mercado de Manga da Embrapa")+
  theme_minimal()+
  theme(axis.text.x=element_text(angle=0, hjust=0.5, size=12, margin = margin(b=20)),
        axis.text.y=element_text(hjust=0.5, size=12, margin = margin(l=20)),
        axis.title.y = element_text(size=12, face = "bold"),
        axis.title.x = element_text(size=12, face = "bold"),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        plot.title = element_text(hjust = 0.5, size=12),
        plot.caption = element_text(hjust = 0, size=12),
        legend.position = "right", legend.title = element_blank(),
        legend.text=element_text(size=10)) # Definindo posição da legenda

ggplotly(g1) %>%
  layout(legend = list(
    orientation = "v",
    x=1.0,
    y=0.1,
    title=''))
```
Fonte: PAM/IBGE reprocessado pelo Observatório de Mercado de Manga da Embrapa

### TABELA 

**VISUALIZAÇÃO DOS DADOS EM TABELA (HECTARES)**

```{r ibge_manga1a}
datatable(dados1, option = list(
  autoWidth = TRUE,
  columnDefs = list(list(className = 'dt-center', targets = "_all"))))

#kable(round(table,2)) %>%
#  kable_styling(full_width = T, bootstrap_options = c("striped", "hover", "condensed"))
```
Fonte: PAM/IBGE reprocessado pelo Observatório de Mercado de Manga da Embrapa
:::

## 1.2 ÁREA NOS PRINCIPAIS ESTADOS PRODUTORES

::: panel-tabset
### GRÁFICO

```{r ibge_manga2}
#Direcionado o R para o Diretorio a ser trabalhado
setwd('/Users/jricardofl/Dropbox/tempecon/dados_manga/2024')

#Entrando dados no R
#dados2 <- read_excel("area_estados.xlsx", col_names = TRUE)
dados2 <- read_excel("area_estados.xlsx", col_names = TRUE, skip = 4, col_types = c('text', "numeric", "numeric", "numeric", "numeric", "numeric", "numeric", "numeric", "numeric", "numeric", "numeric"), na="-")
colnames(dados2)[1] <- 'estados'
dados2 <- dados2[-nrow(dados2),]
dados2 <- na.exclude(dados2)
dados2 <- arrange(dados2, desc(dados2$"2023"))
dados2 <- dados2[c(1:6),]
dados2$estados[6] <- "Rio G. do Norte"
dados2m <- melt(dados2, id.var='estados')

g2 <- ggplot()+
  geom_col(data=dados2m, aes(x=reorder(estados, -value), y=value/1000, fill=variable), lwd=1, position = "dodge")+ scale_fill_manual(values=mycolors2)+
  labs(y= "Área Plantada de Manga (1000 ha)", x= "Estados do Brasil", title='',
       caption = "Fonte: PAM/IBGE reprocessado pelo Observatório de Mercado de Manga da Embrapa")+
  theme_minimal()+
  theme(axis.text.x=element_text(angle=0, hjust=0.5, size=10, margin = margin(b=20)),
        axis.text.y=element_text(hjust=0.5, size=12, margin = margin(l=20)),
        axis.title.y = element_text(size=12, face = "bold"),
        axis.title.x = element_text(size=12, face = "bold"),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        plot.title = element_text(hjust = 0.5, size=12),
        plot.caption = element_text(hjust = 0, size=12),
        legend.position = "right", legend.title = element_blank(),
        legend.text=element_text(size=10)) # Definindo posição da legenda

ggplotly(g2) %>%
  layout(legend = list(
    orientation = "v",
    x=1.0,
    y=0.1,
    title=''))
```
Fonte: PAM/IBGE reprocessado pelo Observatório de Mercado de Manga da Embrapa

### TABELA 

**VISUALIZAÇÃO DOS DADOS EM TABELA (HECTARES)**

```{r ibge_manga2a}
datatable(dados2, option = list(
  autoWidth = TRUE,
  columnDefs = list(list(className = 'dt-center', targets = "_all"))))

#kable(round(table,2)) %>%
#  kable_styling(full_width = T, bootstrap_options = c("striped", "hover", "condensed"))
```
Fonte: PAM/IBGE reprocessado pelo Observatório de Mercado de Manga da Embrapa
:::


## 1.3 ÁREA NAS PRINCIPAIS CIDADES PRODUTORAS

::: panel-tabset
### GRÁFICO

```{r ibge_manga3}
#Direcionado o R para o Diretorio a ser trabalhado
#Entrando dados no R
setwd('/Users/jricardofl/Dropbox/tempecon/dados_manga/2024')

dados3 <- read_excel("area_cidades.xlsx", col_names = TRUE, skip = 4, col_types = c('text', rep("numeric", 10)), na = "-")
colnames(dados3)[1] <- 'cidades'
dados3 <- dados3[-nrow(dados3),]
#dados3$"2013"[dados3$cidades == "Belém do São Francisco (PE)"] <- 600
dados3 <- dados3 |>
  na.exclude() |>
  arrange(desc(`2023`)) 

# Select the top 16 rows and remove columns 2 to 10 (unnecessary columns)
dados3a <- dados3 |>
  slice_head(n = 20) |>
  select(-c(2:10))

dados3m <- melt(dados3a, id.var='cidades')
dados3m_area <- dados3m

g3 <- ggplot()+
  geom_col(data=dados3m, aes(x=reorder(cidades, -value), y=value, fill=variable), lwd=1, position = "dodge")+ scale_fill_manual(values=mycolors3)+
  labs(y= "Área Plantada de Manga (ha)", x= "Cidades do Brasil", title='',
       caption = "Fonte: PAM/IBGE reprocessado pelo Observatório de Mercado de Manga da Embrapa")+
  theme_minimal()+
  theme(axis.text.x=element_text(angle=20, hjust=0.5, size=8, margin = margin(b=20)),
        axis.text.y=element_text(hjust=0.5, size=8, margin = margin(l=20)),
        axis.title.y = element_text(size=10, face = "bold"),
        axis.title.x = element_text(size=10, face = "bold"),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        plot.title = element_text(hjust = 0.5, size=12),
        plot.caption = element_text(hjust = 0, size=12),
        legend.position = "bottom", legend.title = element_blank(),
        legend.text=element_text(size=12)) # Definindo posição da legenda

ggplotly(g3) %>%
  layout(legend = list(
    orientation = "h",
    x=0.35,
    y=-0.35,
    title=''))
```
Fonte: PAM/IBGE reprocessado pelo Observatório de Mercado de Manga da Embrapa

### TABELA 

**VISUALIZAÇÃO DOS DADOS EM TABELA (HECTARES)**

```{r ibge_manga3a}
dados3b <- dados3 |>
  slice_head(n = 20)
datatable(dados3b, option = list(
  autoWidth = TRUE,
  columnDefs = list(list(className = 'dt-center', targets = "_all"))))

#kable(round(table,2)) %>%
#  kable_styling(full_width = T, bootstrap_options = c("striped", "hover", "condensed"))
```
Fonte: PAM/IBGE reprocessado pelo Observatório de Mercado de manga da Embrapa
::: 

## 1.4 ÁREA NO VALE DO S. FRANCISCO 

::: panel-tabset

### GRÁFICO

```{r ibge_manga4}
#Direcionado o R para o Diretorio a ser trabalhado
#Entrando dados no R
setwd('/Users/jricardofl/Dropbox/tempecon/dados_manga/2024')

dados4 <- read_excel("area_vale.xlsx", col_names = TRUE, skip = 4, 
                     col_types = c('text', rep("numeric", 10)), na = "-")

colnames(dados4)[1] <- 'mesorregiao'
dados4 <- dados4[-nrow(dados4),]

dados4a <- dados4[,-1] %>%
  summarise_all(sum)

dados4a$mesorregiao <- "Vale do São Francisco"
dados4a <- dados4a %>% select(mesorregiao, everything())
dados4m <- melt(dados4a, id.var='mesorregiao')
dados4m_area <- dados4m
mycolors4 <- "blue"

g4 <- ggplot()+
  geom_col(data=dados4m, aes(x=variable, y=value/1000, fill="Area Manga (Hectares)"), lwd=1)+
  scale_fill_manual(values=mycolors4)+
  labs(y= "Área Plantada de Manga (mil ha)", x= "Vale do São Francisco", title='',
       caption = "Fonte: PAM/IBGE reprocessado pelo Observatório de Mercado de Manga da Embrapa")+
  theme_minimal()+
  theme(axis.text.x=element_text(angle=0, hjust=0.5, size=12, margin = margin(b=20)),
        axis.text.y=element_text(hjust=0.5, size=12, margin = margin(l=20)),
        axis.title.y = element_text(size=12, face = "bold"),
        axis.title.x = element_text(size=12, face = "bold"),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        plot.title = element_text(hjust = 0.5, size=12),
        plot.caption = element_text(hjust = 0, size=12),
        legend.position = "bottom", legend.title = element_blank(),
        legend.text=element_text(size=12)) # Definindo posição da legenda

ggplotly(g4) %>%
  layout(legend = list(
    orientation = "h",
    x=0.35,
    y=-0.2,
    title=''))
```
Fonte: PAM/IBGE reprocessado pelo Observatório de Mercado de Manga da Embrapa

### TABELA 

**VISUALIZAÇÃO DOS DADOS EM TABELA (HECTARES)**

```{r ibge_manga4a}
datatable(dados4a, option = list(
  autoWidth = TRUE,
  columnDefs = list(list(className = 'dt-center', targets = "_all"))))

#kable(round(table,2)) %>%
#  kable_styling(full_width = T, bootstrap_options = c("striped", "hover", "condensed"))
```
Fonte: PAM/IBGE reprocessado pelo Observatório de Mercado de manga da Embrapa

::: 

# 2. ATUALIZAÇÃO DADOS SOBRE PRODUÇÃO DA CULTURA DA MANGA.

## 2.1 QUANTIDADE NO BRASIL E REGIÕES

::: panel-tabset

### GRÁFICO

```{r ibge_manga5}
#Direcionado o R para o Diretorio a ser trabalhado
setwd('/Users/jricardofl/Dropbox/tempecon/dados_manga/2024')

#Entrando dados no R
dados1 <- read_excel("quanti_regioes.xlsx", col_names = TRUE, skip = 4, col_types = c('text', rep("numeric", 10)), na = "-")

colnames(dados1)[1] <- 'regiao'
dados1 <- dados1[-nrow(dados1),]
dados1m <- melt(dados1, id.var='regiao')

dados1m_quanti <- dados1m

g1 <- ggplot()+
  geom_col(data=dados1m, aes(x=reorder(regiao, -value), y=value/1000, fill=variable), lwd=1, position = "dodge")+ scale_fill_manual(values=mycolors2)+
  labs(y= "Quantidade Produzida de Manga (Mil t)", x= "Brasil e Regiões", title='',
       caption = "Fonte: PAM/IBGE reprocessado pelo Observatório de Mercado de Manga da Embrapa")+
  theme_minimal()+
  theme(axis.text.x=element_text(angle=0, hjust=0.5, size=10, margin = margin(b=20)),
        axis.text.y=element_text(hjust=0.5, size=12, margin = margin(l=20)),
        axis.title.y = element_text(size=12, face = "bold"),
        axis.title.x = element_text(size=12, face = "bold"),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        plot.title = element_text(hjust = 0.5, size=12),
        plot.caption = element_text(hjust = 0, size=12),
        legend.position = "right", legend.title = element_blank(),
        legend.text=element_text(size=10)) # Definindo posição da legenda

ggplotly(g1) %>%
  layout(legend = list(
    orientation = "v",
    x=1.0,
    y=0.1,
    title=''))
```
Fonte: PAM/IBGE reprocessado pelo Observatório de Mercado de Manga da Embrapa

### TABELA 

**VISUALIZAÇÃO DOS DADOS EM TABELA (TONELADAS)**

```{r ibge_manga5a}
datatable(dados1, option = list(
  autoWidth = TRUE,
  columnDefs = list(list(className = 'dt-center', targets = "_all"))))

#kable(round(table,2)) %>%
#  kable_styling(full_width = T, bootstrap_options = c("striped", "hover", "condensed"))
```
Fonte: PAM/IBGE reprocessado pelo Observatório de Mercado de Manga da Embrapa
:::

## 2.2 QUANTIDADE NOS PRINCIPAIS ESTADOS PRODUTORES

::: panel-tabset
### GRÁFICO

```{r ibge_manga6}
#Direcionado o R para o Diretorio a ser trabalhado
setwd('/Users/jricardofl/Dropbox/tempecon/dados_manga/2024')

#Entrando dados no R
#Entrando dados no R
dados2 <- read_excel("quanti_estados.xlsx", col_names = TRUE, skip = 4, 
                     col_types = c('text', rep("numeric", 10)), na = "-")
colnames(dados2)[1] <- 'estados'
dados2 <- dados2[-nrow(dados2),]
dados2 <- na.exclude(dados2)
dados2 <- arrange(dados2, desc(dados2$"2023"))
dados2 <- dados2[c(1:6),]
dados2$estados[6] <- "Rio G. do Norte"
dados2m <- melt(dados2, id.var='estados')

g2 <- ggplot()+
  geom_col(data=dados2m, aes(x=reorder(estados, -value), y=value/1000, fill=variable), lwd=1, position = "dodge")+ scale_fill_manual(values=mycolors2)+
  labs(y= "Quantidade Produzida de Manga (Mil t)", x= "Estados do Brasil", title='',
       caption = "Fonte: PAM/IBGE reprocessado pelo Observatório de Mercado de Manga da Embrapa")+
  theme_minimal()+
  theme(axis.text.x=element_text(angle=0, hjust=0.5, size=10, margin = margin(b=20)),
        axis.text.y=element_text(hjust=0.5, size=12, margin = margin(l=20)),
        axis.title.y = element_text(size=12, face = "bold"),
        axis.title.x = element_text(size=12, face = "bold"),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        plot.title = element_text(hjust = 0.5, size=12),
        plot.caption = element_text(hjust = 0, size=12),
        legend.position = "right", legend.title = element_blank(),
        legend.text=element_text(size=10)) # Definindo posição da legenda

ggplotly(g2) %>%
  layout(legend = list(
    orientation = "v",
    x=1.0,
    y=0.1,
    title=''))
```
Fonte: PAM/IBGE reprocessado pelo Observatório de Mercado de Manga da Embrapa

### TABELA 

**VISUALIZAÇÃO DOS DADOS EM TABELA (TONELADAS)**

```{r ibge_manga6a}
datatable(dados2, option = list(
  autoWidth = TRUE,
  columnDefs = list(list(className = 'dt-center', targets = "_all"))))

#kable(round(table,2)) %>%
#  kable_styling(full_width = T, bootstrap_options = c("striped", "hover", "condensed"))
```
Fonte: PAM/IBGE reprocessado pelo Observatório de Mercado de Manga da Embrapa
:::

## 2.3 QUANTIDADE NAS PRINCIPAIS CIDADES PRODUTORAS

::: panel-tabset

### GRÁFICO

```{r ibge_manga7}
#Direcionado o R para o Diretorio a ser trabalhado
#Entrando dados no R
setwd('/Users/jricardofl/Dropbox/tempecon/dados_manga/2024')
dados3 <- read_excel("quanti_cidades.xlsx", col_names = TRUE, skip = 4, 
                     col_types = c('text', rep("numeric", 10)), na = "-")
colnames(dados3)[1] <- 'cidades'
dados3 <- dados3[-nrow(dados3),]
#dados3$"2013"[dados3$cidades == "Belém do São Francisco (PE)"] <- 600
dados3 <- dados3 |>
  na.exclude() |>
  arrange(desc(`2023`)) # Exclude cities from Rio Grande do Sul (RS)

# Select the top 16 rows and remove columns 2 to 10 (unnecessary columns)
dados3a <- dados3 |>
  slice_head(n = 20) |>
  select(-c(2:10))

#dados3a <- dados3
dados3m <- melt(dados3a, id.var='cidades')
dados3m_quanti <- dados3m

g3 <- ggplot()+
  geom_col(data=dados3m, aes(x=reorder(cidades, -value), y=value/1000, fill=variable), lwd=1, position = "dodge")+ scale_fill_manual(values=mycolors3)+
  labs(y= "Quantidade Produzida de Manga (Mil t)", x= "Cidades do Brasil", title='',
       caption = "Fonte: PAM/IBGE reprocessado pelo Observatório de Mercado de Manga da Embrapa")+
  theme_minimal()+
  theme(axis.text.x=element_text(angle=20, hjust=0.5, size=8, margin = margin(b=20)),
        axis.text.y=element_text(hjust=0.5, size=8, margin = margin(l=20)),
        axis.title.y = element_text(size=10, face = "bold"),
        axis.title.x = element_text(size=10, face = "bold"),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        plot.title = element_text(hjust = 0.5, size=12),
        plot.caption = element_text(hjust = 0, size=12),
        legend.position = "bottom", legend.title = element_blank(),
        legend.text=element_text(size=12)) # Definindo posição da legenda

ggplotly(g3) %>%
  layout(legend = list(
    orientation = "h",
    x=0.35,
    y=-0.35,
    title=''))
```
Fonte: PAM/IBGE reprocessado pelo Observatório de Mercado de Manga da Embrapa

### TABELA 

**VISUALIZAÇÃO DOS DADOS EM TABELA (TONELADAS)**

```{r ibge_manga7a}
dados3 <- dados3 |>
  slice_head(n = 20)

datatable(dados3, option = list(
  autoWidth = TRUE,
  columnDefs = list(list(className = 'dt-center', targets = "_all"))))

#kable(round(table,2)) %>%
#  kable_styling(full_width = T, bootstrap_options = c("striped", "hover", "condensed"))
```
Fonte: PAM/IBGE reprocessado pelo Observatório de Mercado de Manga da Embrapa
:::

## 2.4 QUANTIDADE NO VALE DO S. FRANCISCO 

::: panel-tabset

### GRÁFICO

```{r ibge_manga8}
#Direcionado o R para o Diretorio a ser trabalhado
#Entrando dados no R
setwd('/Users/jricardofl/Dropbox/tempecon/dados_manga/2024')

dados4 <- read_excel("quanti_vale.xlsx", col_names = TRUE, skip = 4, 
                     col_types = c('text', rep("numeric", 10)), na = "-")

colnames(dados4)[1] <- 'mesorregiao'
dados4 <- dados4[-nrow(dados4),]

dados4a <- dados4[,-1] %>%
  summarise_all(sum)

dados4a$mesorregiao <- "Vale do São Francisco"
dados4a <- dados4a %>% select(mesorregiao, everything())
dados4m <- melt(dados4a, id.var='mesorregiao')
dados4m_quanti <- dados4m
mycolors4 <- "blue"

g4 <- ggplot()+
  geom_col(data=dados4m, aes(x=variable, y=value/1000, fill="Quantidade Manga (1000 Toneladas)"), lwd=1)+
  scale_fill_manual(values=mycolors4)+
  labs(y= "Quantidade Produzida de Manga (Mil t)", x= "Vale do São Francisco", title='',
       caption = "Fonte: PAM/IBGE reprocessado pelo Observatório de Mercado de Manga da Embrapa")+
  theme_minimal()+
  theme(axis.text.x=element_text(angle=0, hjust=0.5, size=12, margin = margin(b=20)),
        axis.text.y=element_text(hjust=0.5, size=12, margin = margin(l=20)),
        axis.title.y = element_text(size=12, face = "bold"),
        axis.title.x = element_text(size=12, face = "bold"),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        plot.title = element_text(hjust = 0.5, size=12),
        plot.caption = element_text(hjust = 0, size=12),
        legend.position = "bottom", legend.title = element_blank(),
        legend.text=element_text(size=12)) # Definindo posição da legenda

ggplotly(g4) %>%
  layout(legend = list(
    orientation = "h",
    x=0.3,
    y=-0.2,
    title=''))
```
Fonte: PAM/IBGE reprocessado pelo Observatório de Mercado de Manga da Embrapa

### TABELA 

**VISUALIZAÇÃO DOS DADOS EM TABELA**

```{r ibge_manga8a}
datatable(dados4a, option = list(
  autoWidth = TRUE,
  columnDefs = list(list(className = 'dt-center', targets = "_all"))))

#kable(round(table,2)) %>%
#  kable_styling(full_width = T, bootstrap_options = c("striped", "hover", "condensed"))
```
Fonte: PAM/IBGE reprocessado pelo Observatório de Mercado de Manga da Embrapa

:::

# 3. ATUALIZAÇÃO DADOS SOBRE PRODUTIVIDADE DA CULTURA DA MANGA.

## 3.1 PRODUTIVIDADE NO BRASIL E PRINCIPAIS REGIÕES PRODUTORAS

::: panel-tabset

### GRÁFICO

```{r ibge_manga9}
#Direcionado o R para o Diretorio a ser trabalhado
setwd('/Users/jricardofl/Dropbox/tempecon/dados_manga/2024')

dados1m <- cbind(dados1m_quanti, dados1m_area$value)
dados1m$prod <- dados1m$value/dados1m$`dados1m_area$value`
dados1m <- dados1m[,-c(3:4)]
colnames(dados1m)[3] <- "value"
dados1m$value <- round(dados1m$value,1)
#dados1m$value <- round(dados1m$value/1000,0)

g1 <- ggplot()+
  geom_col(data=dados1m, aes(x=regiao, y=value, fill=variable), lwd=1, position = "dodge")+ scale_fill_manual(values=mycolors2)+
  labs(y= "Produtividade na Manga (t/ha)", x= "Brasil e Regiões", title='',
       caption = "Fonte: PAM/IBGE reprocessado pelo Observatório de Mercado de Manga da Embrapa")+
  theme_minimal()+
  theme(axis.text.x=element_text(angle=0, hjust=0.5, size=10, margin = margin(b=20)),
        axis.text.y=element_text(hjust=0.5, size=12, margin = margin(l=20)),
        axis.title.y = element_text(size=12, face = "bold"),
        axis.title.x = element_text(size=12, face = "bold"),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        plot.title = element_text(hjust = 0.5, size=12),
        plot.caption = element_text(hjust = 0, size=12),
        legend.position = "right", legend.title = element_blank(),
        legend.text=element_text(size=10)) # Definindo posição da legenda

ggplotly(g1) %>%
  layout(legend = list(
    orientation = "v",
    x=1.0,
    y=0.1,
    title=''))
```
Fonte: PAM/IBGE reprocessado pelo Observatório de Mercado de Manga da Embrapa

### TABELA 

**VISUALIZAÇÃO DOS DADOS EM TABELA (T/HA)**

```{r ibge_manga9a}
dados1c <- dcast(dados1m, regiao~variable)

datatable(dados1c, option = list(
  autoWidth = TRUE,
  columnDefs = list(list(className = 'dt-center', targets = "_all"))))

#kable(round(table,2)) %>%
#  kable_styling(full_width = T, bootstrap_options = c("striped", "hover", "condensed"))
```
Fonte: PAM/IBGE reprocessado pelo Observatório de Mercado de manga da Embrapa

:::

## 3.2 PRODUTIVIDADE NOS PRINCIPAIS ESTADOS PRODUTORES

::: panel-tabset

### GRÁFICO

```{r ibge_manga10}
#Direcionado o R para o Diretorio a ser trabalhado
setwd('/Users/jricardofl/Dropbox/tempecon/dados_manga/2024')

#Entrando dados no R
dados2 <- read_excel("produti_estados.xlsx", col_names = TRUE, skip = 4, 
                     col_types = c('text', rep("numeric", 10)), na = "-")

colnames(dados2)[1] <- 'estados'
dados2 <- dados2[-nrow(dados2),]
dados2 <- na.exclude(dados2)
dados2 <- arrange(dados2, desc(dados2$"2023"))
dados2$estados[10] <- "Rio G. do Norte"
dados2 <- dados2[c(1,3,4,10,11,16),]

dados2m <- melt(dados2, id.var='estados')

g2 <- ggplot()+
  geom_col(data=dados2m, aes(x=reorder(estados, -value), y=value/1000, fill=variable), lwd=1, position = "dodge")+ scale_fill_manual(values=mycolors2)+
  labs(y= "Produtividade da Manga (t/ha)", x= "Estados do Brasil", title='',
       caption = "Fonte: PAM/IBGE reprocessado pelo Observatório de Mercado de Manga da Embrapa")+
  theme_minimal()+
  theme(axis.text.x=element_text(angle=0, hjust=0.5, size=10, margin = margin(b=20)),
        axis.text.y=element_text(hjust=0.5, size=12, margin = margin(l=20)),
        axis.title.y = element_text(size=10, face = "bold"),
        axis.title.x = element_text(size=10, face = "bold"),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        plot.title = element_text(hjust = 0.5, size=12),
        plot.caption = element_text(hjust = 0, size=12),
        legend.position = "right", legend.title = element_blank(),
        legend.text=element_text(size=10)) # Definindo posição da legenda

ggplotly(g2) %>%
  layout(legend = list(
    orientation = "v",
    x=1.0,
    y=0.1,
    title=''))
```
Fonte: PAM/IBGE reprocessado pelo Observatório de Mercado de Manga da Embrapa

### TABELA 

**VISUALIZAÇÃO DOS DADOS EM TABELA (T/HA)**

```{r ibge_manga10a}
dados2t <- dados2[,1]
dados2 <- round(dados2[,c(2:11)]/1000,1)
dados2 <- cbind(dados2t, dados2)

datatable(dados2, option = list(
  autoWidth = TRUE,
  columnDefs = list(list(className = 'dt-center', targets = "_all"))))

#kable(round(table,2)) %>%
#  kable_styling(full_width = T, bootstrap_options = c("striped", "hover", "condensed"))
```
Fonte: PAM/IBGE reprocessado pelo Observatório de Mercado de manga da Embrapa

:::

## 3.3 PRODUTIVIDADE NAS PRINCIPAIS CIDADES PRODUTORAS

::: panel-tabset

### GRÁFICO

```{r ibge_manga11}
#Direcionado o R para o Diretorio a ser trabalhado
#Entrando dados no R
setwd('/Users/jricardofl/Dropbox/tempecon/dados_manga/2024')

# Merge data with inner join
dados3m <- inner_join(dados3m_quanti, dados3m_area, by="cidades")
#dados3m <- dados3m |>
#  filter(variable.x == 2023)
dados3m$value <- dados3m$value.x/dados3m$value.y
dados3m$variable <- dados3m$variable.x
dados3m <- dados3m[,-c(2:5)]
dados3m$value <- round(dados3m$value,1)

g3 <- ggplot()+
  geom_col(data=dados3m, aes(x=reorder(cidades, -value), y=value, fill=variable), lwd=1, position = "dodge")+ scale_fill_manual(values=mycolors3)+
  labs(y= "Produtividade na Manga (t/ha)", x= "Cidades do Brasil", title='',
       caption = "Fonte: PAM/IBGE reprocessado pelo Observatório de Mercado de Manga da Embrapa")+
  theme_minimal()+
  theme(axis.text.x=element_text(angle=20, hjust=0.5, size=8, margin = margin(b=20)),
        axis.text.y=element_text(hjust=0.5, size=8, margin = margin(l=20)),
        axis.title.y = element_text(size=10, face = "bold"),
        axis.title.x = element_text(size=10, face = "bold"),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        plot.title = element_text(hjust = 0.5, size=12),
        plot.caption = element_text(hjust = 0, size=12),
        legend.position = "bottom", legend.title = element_blank(),
        legend.text=element_text(size=12)) # Definindo posição da legenda

ggplotly(g3) %>%
  layout(legend = list(
    orientation = "h",
    x=0.35,
    y=-0.35,
    title=''))
```
Fonte: PAM/IBGE reprocessado pelo Observatório de Mercado de Manga da Embrapa

### TABELA 

**VISUALIZAÇÃO DOS DADOS EM TABELA (T/HA)**

```{r ibge_manga11a}
dados3m_t <- dados3m[,-3]
dados3m_t <- arrange(dados3m_t, desc(dados3m_t$"value"))
colnames(dados3m_t)[2] <- 'Produtividade em 2023'
datatable(dados3m_t, option = list(
  autoWidth = TRUE,
  columnDefs = list(list(className = 'dt-center', targets = "_all"))))

#kable(round(table,2)) %>%
#  kable_styling(full_width = T, bootstrap_options = c("striped", "hover", "condensed"))
```
Fonte: PAM/IBGE reprocessado pelo Observatório de Mercado de Manga da Embrapa
::: 

## 3.4 PRODUTIVIDADE NO VALE DO S. FRANCISCO 

::: panel-tabset

### GRÁFICO

```{r ibge_manga12}
#Direcionado o R para o Diretório a ser trabalhado
#Entrando dados no R
setwd('/Users/jricardofl/Dropbox/tempecon/dados_manga/2024')

dados4m <- inner_join(dados4m_quanti, dados4m_area, by="variable")
dados4m$value <- dados4m$value.x/dados4m$value.y
dados4m$value <- round(dados4m$value,1)
dados4m <- dados4m[,-c(3:5)]
colnames(dados4m)[1] <- "mesorregiao"

g4 <- ggplot()+
  geom_col(data=dados4m, aes(x=variable, y=value, fill="Produtividade manga"), lwd=1)+
  scale_fill_manual(values=mycolors4)+
  labs(y= "Produtividade da Manga (t/ha)", x= "Vale do São Francisco", title='',
       caption = "Fonte: PAM/IBGE reprocessado pelo Observatório de Mercado de Manga da Embrapa")+
  theme_minimal()+
  theme(axis.text.x=element_text(angle=0, hjust=0.5, size=12, margin = margin(b=20)),
        axis.text.y=element_text(hjust=0.5, size=12, margin = margin(l=20)),
        axis.title.y = element_text(size=12, face = "bold"),
        axis.title.x = element_text(size=12, face = "bold"),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        plot.title = element_text(hjust = 0.5, size=12),
        plot.caption = element_text(hjust = 0, size=12),
        legend.position = "bottom", legend.title = element_blank(),
        legend.text=element_text(size=12)) # Definindo posição da legenda

ggplotly(g4) %>%
  layout(legend = list(
    orientation = "h",
    x=0.3,
    y=-0.2,
    title=''))
```
Fonte: PAM/IBGE reprocessado pelo Observatório de Mercado de Manga da Embrapa

### TABELA 

**VISUALIZAÇÃO DOS DADOS EM TABELA (T/HA)**

```{r ibge_manga12a}
dados4c <- dcast(dados4m, mesorregiao~variable)
datatable(dados4c, option = list(
  autoWidth = TRUE,
  columnDefs = list(list(className = 'dt-center', targets = "_all"))))

#kable(round(table,2)) %>%
#  kable_styling(full_width = T, bootstrap_options = c("striped", "hover", "condensed"))
```
Fonte: PAM/IBGE reprocessado pelo Observatório de Mercado de Manga da Embrapa

:::

# 4. ATUALIZAÇÃO DADOS SOBRE VALOR DA PRODUÇÃO DA CULTURA DA MANGA.

## 4.1 VALOR DA PRODUÇÃO NO BRASIL E REGIÕES

::: panel-tabset

### GRÁFICO

```{r ibge_manga13}
#Direcionado o R para o Diretorio a ser trabalhado
setwd('/Users/jricardofl/Dropbox/tempecon/dados_manga/2024')

#Entrando dados no R
#Entrando dados no R
#dados1 <- read_excel("valor_regioes.xlsx", col_names = TRUE)
dados1 <- read_excel("valor_regioes.xlsx", col_names = TRUE, skip = 4, 
                     col_types = c('text', rep("numeric", 10)), na = "-")

colnames(dados1)[1] <- 'regiao'
dados1 <- dados1[-nrow(dados1),]

dados1m <- melt(dados1, id.var='regiao')
dados1m$value <- round(dados1m$value/1000,2)

g1 <- ggplot()+
  geom_col(data=dados1m, aes(x=reorder(regiao, -value), y=value, fill=variable), lwd=1, position = "dodge")+ scale_fill_manual(values=mycolors2)+
  labs(y= "Valor da Produção (R$ milhões)", x= "Brasil e Regiões", title='',
       caption = "Fonte: PAM/IBGE reprocessado pelo Observatório de Mercado de Manga da Embrapa")+
  theme_minimal()+
  theme(axis.text.x=element_text(angle=0, hjust=0.5, size=12, margin = margin(b=20)),
        axis.text.y=element_text(hjust=0.5, size=12, margin = margin(l=20)),
        axis.title.y = element_text(size=12, face = "bold"),
        axis.title.x = element_text(size=12, face = "bold"),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        plot.title = element_text(hjust = 0.5, size=12),
        plot.caption = element_text(hjust = 0, size=12),
        legend.position = "right", legend.title = element_blank(),
        legend.text=element_text(size=10)) # Definindo posição da legenda

ggplotly(g1) %>%
  layout(legend = list(
    orientation = "v",
    x=1.0,
    y=0.1,
    title=''))
```
Fonte: PAM/IBGE reprocessado pelo Observatório de Mercado de Manga da Embrapa

### TABELA 

**VISUALIZAÇÃO DOS DADOS (R$ MILHÕES) EM TABELA**

```{r ibge_manga13a}
dados1t <- dados1[,1]
dados1 <- round(dados1[,c(2:11)]/1000,1)
dados1 <- cbind(dados1t, dados1)

colnames(dados1)[1] = "regioes"

datatable(dados1, option = list(
  autoWidth = TRUE,
  columnDefs = list(list(className = 'dt-center', targets = "_all"))))
#kable(round(table,2)) %>%
#  kable_styling(full_width = T, bootstrap_options = c("striped", "hover", "condensed"))
```
Fonte: PAM/IBGE reprocessado pelo Observatório de Mercado de Manga da Embrapa
:::

## 4.2 VALOR DA PRODUÇÃO NOS PRINCIPAIS ESTADOS PRODUTORES

::: panel-tabset

### GRÁFICO

```{r ibge_manga14}
#Direcionado o R para o Diretorio a ser trabalhado
setwd('/Users/jricardofl/Dropbox/tempecon/dados_manga/2024')

#Entrando dados no R
dados2 <- read_excel("valor_estados.xlsx", col_names = TRUE, skip = 4, 
                     col_types = c('text', rep("numeric", 10)), na = "-")

colnames(dados2)[1] <- 'estados'
dados2 <- dados2[-nrow(dados2),]
dados2 <- na.exclude(dados2)
dados2 <- arrange(dados2, desc(dados2$"2023"))
dados2$estados[5] <- "Rio G. do Norte"
dados2 <- dados2[c(1:6),]
dados2m <- melt(dados2, id.var='estados')

g2 <- ggplot()+
  geom_col(data=dados2m, aes(x=reorder(estados, -value), y=value/1000, fill=variable), lwd=1, position = "dodge")+ scale_fill_manual(values=mycolors2)+
  labs(y= "Valor da Produção (R$ milhões)", x= "Estados do Brasil", title='',
       caption = "Fonte: PAM/IBGE reprocessado pelo Observatório de Mercado de Manga da Embrapa")+
  theme_minimal()+
  theme(axis.text.x=element_text(angle=0, hjust=0.5, size=10, margin = margin(b=20)),
        axis.text.y=element_text(hjust=0.5, size=12, margin = margin(l=20)),
        axis.title.y = element_text(size=10, face = "bold"),
        axis.title.x = element_text(size=10, face = "bold"),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        plot.title = element_text(hjust = 0.5, size=12),
        plot.caption = element_text(hjust = 0, size=12),
        legend.position = "right", legend.title = element_blank(),
        legend.text=element_text(size=10)) # Definindo posição da legenda

ggplotly(g2) %>%
  layout(legend = list(
    orientation = "v",
    x=1.0,
    y=0.1,
    title=''))
```
Fonte: PAM/IBGE reprocessado pelo Observatório de Mercado de Manga da Embrapa

### TABELA 

**VISUALIZAÇÃO DOS DADOS (R$ MILHÕES) EM TABELA**

```{r ibge_manga14a}

dados2t <- dados2[,1]
dados2 <- round(dados2[,c(2:11)]/1000,1)
dados2 <- cbind(dados2t, dados2)

datatable(dados2, option = list(
  autoWidth = TRUE,
  columnDefs = list(list(className = 'dt-center', targets = "_all"))))

#kable(round(table,2)) %>%
#  kable_styling(full_width = T, bootstrap_options = c("striped", "hover", "condensed"))
```
Fonte: PAM/IBGE reprocessado pelo Observatório de Mercado de Manga da Embrapa
:::

## 4.3 VALOR DA PRODUÇÃO NAS PRINCIPAIS CIDADES PRODUTORAS

::: panel-tabset

### GRÁFICO

```{r ibge_manga15}
#Direcionado o R para o Diretorio a ser trabalhado
setwd('/Users/jricardofl/Dropbox/tempecon/dados_manga/2024')

#Entrando dados no R
dados3 <- read_excel("valor_cidades.xlsx", col_names = TRUE, skip = 4, 
                     col_types = c('text', rep("numeric", 10)), na = "-")

colnames(dados3)[1] <- 'cidades'
dados3 <- dados3[-nrow(dados3),]
#dados3$"2013"[dados3$cidades == "Belém do São Francisco (PE)"] <- 13440

dados3 <- dados3 |>
  na.exclude() |>
  arrange(desc(`2023`))

# Select the top 16 rows and remove columns 2 to 10 (unnecessary columns)
dados3a <- dados3 |>
  slice_head(n = 20) |>
  select(-c(2:10))

dados3m <- melt(dados3a, id.var='cidades')

g3 <- ggplot()+
  geom_col(data=dados3m, aes(x=reorder(cidades, -value), y=value/1000, fill=variable), lwd=1, position = "dodge")+ scale_fill_manual(values=mycolors3)+
  labs(y= "Valor da Produção (R$ milhões)", x= "Cidades do Brasil", title='',
       caption = "Fonte: PAM/IBGE reprocessado pelo Observatório de Mercado de Manga da Embrapa")+
  theme_minimal()+
  theme(axis.text.x=element_text(angle=20, hjust=0.5, size=8, margin = margin(b=20)),
        axis.text.y=element_text(hjust=0.5, size=8, margin = margin(l=20)),
        axis.title.y = element_text(size=10, face = "bold"),
        axis.title.x = element_text(size=10, face = "bold"),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        plot.title = element_text(hjust = 0.5, size=12),
        plot.caption = element_text(hjust = 0, size=12),
        legend.position = "bottom", legend.title = element_blank(),
        legend.text=element_text(size=12)) # Definindo posição da legenda

ggplotly(g3) %>%
  layout(legend = list(
    orientation = "h",
    x=0.35,
    y=-0.35,
    title=''))
```
Fonte: PAM/IBGE reprocessado pelo Observatório de Mercado de Manga da Embrapa

### TABELA 

**VISUALIZAÇÃO DOS DADOS (R$ MIL) EM TABELA**

```{r ibge_manga15a}

dados3 <- dados3 |>
  slice_head(n = 20)

datatable(dados3, option = list(
  autoWidth = TRUE,
  columnDefs = list(list(className = 'dt-center', targets = "_all"))))

#kable(round(table,2)) %>%
#  kable_styling(full_width = T, bootstrap_options = c("striped", "hover", "condensed"))
```
Fonte: PAM/IBGE reprocessado pelo Observatório de Mercado de Manga da Embrapa
:::

## 4.4 VALOR DA PRODUÇÃO NO VALE DO S. FRANCISCO 

::: panel-tabset

### GRÁFICO

```{r ibge_manga16}
#Direcionado o R para o Diretório a ser trabalhado
#Entrando dados no R
setwd('/Users/jricardofl/Dropbox/tempecon/dados_manga/2024')
dados4 <- read_excel("valor_vale.xlsx", col_names = TRUE, skip = 4, 
                     col_types = c('text', rep("numeric", 10)), na = "-")

colnames(dados4)[1] <- 'mesorregiao'
dados4 <- dados4[-nrow(dados4),]

dados4a <- dados4[,-1] %>%
  summarise_all(sum)

dados4a$mesorregiao <- "Vale do São Francisco"
dados4a <- dados4a %>% select(mesorregiao, everything())
dados4m <- melt(dados4a, id.var='mesorregiao')
mycolors4 <- "blue"

g4 <- ggplot()+
  geom_col(data=dados4m, aes(x=variable, y=value/1000, fill="Valor da Produção"), lwd=1)+
  scale_fill_manual(values=mycolors4)+
  labs(y= "Valor da Produção (R$ milhões)", x= "Vale do São Francisco", title='',
       caption = "Fonte: PAM/IBGE reprocessado pelo Observatório de Mercado de Manga da Embrapa")+
  theme_minimal()+
  theme(axis.text.x=element_text(angle=0, hjust=0.5, size=12, margin = margin(b=20)),
        axis.text.y=element_text(hjust=0.5, size=12, margin = margin(l=20)),
        axis.title.y = element_text(size=12, face = "bold"),
        axis.title.x = element_text(size=12, face = "bold"),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        plot.title = element_text(hjust = 0.5, size=12),
        plot.caption = element_text(hjust = 0, size=12),
        legend.position = "bottom", legend.title = element_blank(),
        legend.text=element_text(size=12)) # Definindo posição da legenda

ggplotly(g4) %>%
  layout(legend = list(
    orientation = "h",
    x=0.4,
    y=-0.2,
    title=''))
```
Fonte: PAM/IBGE reprocessado pelo Observatório de Mercado de Manga da Embrapa


### TABELA 

**VISUALIZAÇÃO DOS DADOS (R$ MILHÕES) EM TABELA**

```{r ibge_manga16a}
dados4a_t <- dados4a[,1]
dados4a <- round(dados4a[,c(2:11)]/1000,1)
dados4a <- cbind(dados4a_t, dados4a)

datatable(dados4a, option = list(
  autoWidth = TRUE,
  columnDefs = list(list(className = 'dt-center', targets = "_all"))))

#kable(round(table,2)) %>%
#  kable_styling(full_width = T, bootstrap_options = c("striped", "hover", "condensed"))
```
Fonte: PAM/IBGE reprocessado pelo Observatório de Mercado de Manga da Embrapa

:::

# INFORMAÇÕES E APOIO



<center>![](logo_manga.png){width="10cm"}</center>



<center>João Ricardo F. de Lima</center>

<center>Email Coordenador: joao.ricardo\@embrapa.br</center>



<center><https://www.embrapa.br/observatorio-da-manga></center>

<center>[Dashboard Mercado de Manga](https://bit.ly/3OgmyKp)</center>



<center>Telefones:</center>

<center>87-3866-3667</center>

<center>87-99961-5799</center>



<center>![](apoio1.png){width="7cm"}</center>
